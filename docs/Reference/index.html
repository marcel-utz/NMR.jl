<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Reference · NMR.jl</title><meta name="title" content="Reference · NMR.jl"/><meta property="og:title" content="Reference · NMR.jl"/><meta property="twitter:title" content="Reference · NMR.jl"/><meta name="description" content="Documentation for NMR.jl."/><meta property="og:description" content="Documentation for NMR.jl."/><meta property="twitter:description" content="Documentation for NMR.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">NMR.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">NMR.jl</a></li><li><a class="tocitem" href="../Manual/">User Manual</a></li><li><a class="tocitem" href="../NMR-1.0/">Roadmap to Version 1.0</a></li><li class="is-active"><a class="tocitem" href>Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Reference</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Reference</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/marcel-utz/NMR.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/marcel-utz/NMR.jl/blob/master/docs/src/Reference.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Reference"><a class="docs-heading-anchor" href="#Reference">Reference</a><a id="Reference-1"></a><a class="docs-heading-anchor-permalink" href="#Reference" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NMR.AutoPhaseCorrect-Tuple{Data1D}" href="#NMR.AutoPhaseCorrect-Tuple{Data1D}"><code>NMR.AutoPhaseCorrect</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AutoPhaseCorrect(spect::Data1D; exclude=false,threshold=10)</code></pre><p>performs zero- and first-order phase correction of <code>spect</code> using a the algorithm by van der Waals and Geerens, <em>Journal of Magnetic Resonance</em> <strong>86</strong> (1990) 127-154. It works by recognising the peaks in the magnitude mode spectrum and then representing the phase at each peak location through a linear regression.</p><p>Passing a pair of indices to <code>exclude</code> disregards any peaks  between these two boundaries. This is useful in spectra that contain a solvent artefact that may not be phased correctly.</p><p><code>threshold</code> defines a threshold for peak detection (cf. <code>NMR.peaks()</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/marcel-utz/NMR.jl/blob/60c7aacb0d9c677814c4e653dc4a17bdd8df2854/src/AutoPhase.jl#L72-L87">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NMR.AutoPhaseCorrectChen-Tuple{Data1D}" href="#NMR.AutoPhaseCorrectChen-Tuple{Data1D}"><code>NMR.AutoPhaseCorrectChen</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><code>AutoPhaseCorrectChen(spect::Data1D;verbose=false)</code> performs zero- and first-order phase correction of <code>spect</code> using a minimum entropy algorithm  by Chen et al. in <em>Journal of Magnetic Resonance</em> <strong>158</strong> (2002) 164–168. It uses the Nelder-Mead algorithm, as implemented in the <code>Optim.jl</code> package.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/marcel-utz/NMR.jl/blob/60c7aacb0d9c677814c4e653dc4a17bdd8df2854/src/AutoPhase.jl#L37-L44">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NMR.BaseLineCorrect-Tuple{Data1D}" href="#NMR.BaseLineCorrect-Tuple{Data1D}"><code>NMR.BaseLineCorrect</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><strong>Automatic Baseline Correction</strong></p><p><code>BaseLineCorrect(spect::Data1D;regions=128,kfactor=5,wdw=32)</code> corrects the base line of <code>spect</code> using the algorithm by S. Golotvin, A. Williams, J. Magn. Reson. 146 (2000) 122-125.</p><p><strong>Optional Parameters:</strong></p><ul><li><p><code>regions</code>: the number of regions the spectrum is divided into to estimate  the noise variance. This should be chosen large enough so that at least one  of these regions is free from signals, and shows a flat baseline. The   variance <span>$\\sigma^2_{min}$</span> in this region is then used to distinguish signals and noise.</p></li><li><p><code>wdw</code>: the window size around each data point that is used to decide whether the data point is part of a signal, or should be counted as base line. </p></li><li><p><code>kfactor</code>: a point will be counted as part of the baseline if and only if the local variance in its window is less than <code>kfactor</code>*<span>$\\sigma^2_{min}$</span>.</p></li><li><p><code>output</code>: defaults to <code>:spectrum</code>. <code>output=:points</code> will return an array of points, which indicate baseline positions (locations free from peaks) as determined by the algorithm. This is useful in situations where a large number of similar spectra need to be processed.</p></li></ul><p><strong>Notes</strong></p><ul><li><p>if the input data is complex, the imaginary part is ignored, and the result is always real.</p></li><li><p>the first and last point of <code>spect</code> are always used as part of the baseline.  The first and last points of the output are therefore guaranteed to be zero. This helps to keep the interpolation numerically stable.</p></li></ul><p><strong>Baseline Correction With Known Locations</strong></p><p><code>BaseLineCorrect(spect::Data1D,pts::Array{Float64,1})</code> uses the points in <code>pts</code> to determine the baseline. This should be a list of positions in the spectrum that are known not to contain signal; it can be obtained by using the option <code>output=:points</code> in the first method of <code>BaseLineCorrect()</code>. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/marcel-utz/NMR.jl/blob/60c7aacb0d9c677814c4e653dc4a17bdd8df2854/src/DataSet.jl#L133-L174">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NMR.FourierTransform-Tuple{Data1D}" href="#NMR.FourierTransform-Tuple{Data1D}"><code>NMR.FourierTransform</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">FourierTransform(d::Data1D)</code></pre><p>performs an FFT assuming that the input data set <code>d</code> is a free induction decay, and returns a <code>DataSet</code> object with the resulting complex data.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/marcel-utz/NMR.jl/blob/60c7aacb0d9c677814c4e653dc4a17bdd8df2854/src/DataSet.jl#L85-L91">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NMR.FromXML-Tuple{LightXML.XMLElement}" href="#NMR.FromXML-Tuple{LightXML.XMLElement}"><code>NMR.FromXML</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> FromXML(e::XMLElement)</code></pre><p>converts XML representation to <code>PeakStruct</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/marcel-utz/NMR.jl/blob/60c7aacb0d9c677814c4e653dc4a17bdd8df2854/src/Peaks.jl#L131-L136">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NMR.PeakSpect-Tuple{Any, Any, Any}" href="#NMR.PeakSpect-Tuple{Any, Any, Any}"><code>NMR.PeakSpect</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">function PeakSpect(p,i,r;lw=0.0001)</code></pre><p>compute the the spectrum with Lorentzian peaks at locations given in array <code>p</code> and (complex) amplitudes in array <code>i</code>, over the range <code>r</code>, which can be either an array or a range. lw<code>is the line width. A</code>Data1D` object is returned.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/marcel-utz/NMR.jl/blob/60c7aacb0d9c677814c4e653dc4a17bdd8df2854/src/SpinSim.jl#L336-L343">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NMR.PhaseCorrect-Tuple{Data1D}" href="#NMR.PhaseCorrect-Tuple{Data1D}"><code>NMR.PhaseCorrect</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><code>PhaseCorrect(spect::Data1D;Ph0=0.0,Ph1=0.0,Pivot=0.0)</code> returns a phase corrected <code>DataSet</code>, using the values indicated. The parameters are given in rad, k, and rad/k, where k are the units of the spectral domain (typically, Hz or ppm).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/marcel-utz/NMR.jl/blob/60c7aacb0d9c677814c4e653dc4a17bdd8df2854/src/DataSet.jl#L110-L115">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NMR.Spectrum-Tuple{Any, Any, Any}" href="#NMR.Spectrum-Tuple{Any, Any, Any}"><code>NMR.Spectrum</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">    function Spectrum(ρ,H,Ψ;tol=1e-3)</code></pre><p>compute the frequencies and intensities of the spectrum given by the the initial density operator ρ, the Hamiltonian H, and the observation operator Ψ. The results are returned as a tuple <code>(freq,int)</code> of two one-dimensional arrays. <code>tol</code> is a cutoff; transitions with absolute amplitudes less than this value are suppressed.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/marcel-utz/NMR.jl/blob/60c7aacb0d9c677814c4e653dc4a17bdd8df2854/src/SpinSim.jl#L303-L311">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NMR.ToXML-Tuple{PeakStruct}" href="#NMR.ToXML-Tuple{PeakStruct}"><code>NMR.ToXML</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ToXML(p)</code></pre><p>generates an XML structure containing the peak intensities, positions, and widths contained in the <code>PeakStruct</code> <code>p</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/marcel-utz/NMR.jl/blob/60c7aacb0d9c677814c4e653dc4a17bdd8df2854/src/Peaks.jl#L113-L119">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NMR.clorentzian-Tuple{Float64, Float64, Float64}" href="#NMR.clorentzian-Tuple{Float64, Float64, Float64}"><code>NMR.clorentzian</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">clorentzian(x0::Float64,σ::Float64,x::Float64)</code></pre><p>returns the complex Lorentzian</p><p><span>$L(x) = \sqrt{\sigma}\dfrac{1+i\sqrt{\sigma}(x-x_0)}{1+\sigma(x-x_0)^2}$</span></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/marcel-utz/NMR.jl/blob/60c7aacb0d9c677814c4e653dc4a17bdd8df2854/src/Peaks.jl#L43-L49">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NMR.derivative-Tuple{Data1D}" href="#NMR.derivative-Tuple{Data1D}"><code>NMR.derivative</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><code>derivative(spect::Data1D)</code> computes the derivative of <code>spect</code> and returns it as another Data1D object</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/marcel-utz/NMR.jl/blob/60c7aacb0d9c677814c4e653dc4a17bdd8df2854/src/DataSet.jl#L275-L278">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NMR.entropy-Tuple{Data1D}" href="#NMR.entropy-Tuple{Data1D}"><code>NMR.entropy</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><code>entropy(spect::Data1D)</code> computes the entropy of the first derivative in the real part of an NMR spectrum as defined by Chen et al. in <em>Journal of Magnetic Resonance</em> <strong>158</strong> (2002) 164–168. This quantity can be optimised with respect to zero- and first-order phase correction for automatic (unsupervised) phase correction.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/marcel-utz/NMR.jl/blob/60c7aacb0d9c677814c4e653dc4a17bdd8df2854/src/AutoPhase.jl#L10-L17">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NMR.hard_shift-Tuple{Data1D, Number}" href="#NMR.hard_shift-Tuple{Data1D, Number}"><code>NMR.hard_shift</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><code>function hard_shift(d::Data1D,δ::Number)</code></p><p>shifts the data in <code>d</code> by <code>δ</code>. The data is re-interpolated as needed. The resulting <code>Data1D</code> object is guaranteed to have the same index as <code>d</code>, such that they are compatible for the purposes of addition etc. Data shifted out of the  window is lost; data points shifted into view are set to zero.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/marcel-utz/NMR.jl/blob/60c7aacb0d9c677814c4e653dc4a17bdd8df2854/src/DataSet.jl#L370-L377">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NMR.integral-Tuple{Data1D}" href="#NMR.integral-Tuple{Data1D}"><code>NMR.integral</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><code>integral(spect::Data1D)</code> computes the numerical integral of <code>spect</code> by the trapezoid rule.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/marcel-utz/NMR.jl/blob/60c7aacb0d9c677814c4e653dc4a17bdd8df2854/src/DataSet.jl#L265-L268">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NMR.medianBaseline-Union{Tuple{Data1D{Tdata, Tindex}}, Tuple{Tindex}, Tuple{Tdata}} where {Tdata&lt;:Real, Tindex}" href="#NMR.medianBaseline-Union{Tuple{Data1D{Tdata, Tindex}}, Tuple{Tindex}, Tuple{Tdata}} where {Tdata&lt;:Real, Tindex}"><code>NMR.medianBaseline</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">function medianBaseline(s::NMR.Data1D;wdw=length(s)&gt;&gt;6)</code></pre><p>Compute baseline for the real part of <code>s</code> by the algorithm of M. S. Friedrichs, <em>Journal of Biomolecular NMR</em>,  <strong>5</strong> (1995) 147  153. The window is automatically calculated as <span>$\Delta\omega/2^6$</span>, unless overridden by giving a value to the optional key <code>wdw</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/marcel-utz/NMR.jl/blob/60c7aacb0d9c677814c4e653dc4a17bdd8df2854/src/DataSet.jl#L235-L243">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NMR.peaks-Tuple{Data1D}" href="#NMR.peaks-Tuple{Data1D}"><code>NMR.peaks</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">peaks(dinput::Data1D;threshold=1,athresh=1,regions=128)</code></pre><p>identifies the peaks in <code>dinput</code>. Peak positions are located roughly by searching for the downward zero crossings of the first derivative. The data points surrounding each peak are then used for a quadratic regression, from which the position, curvature, and height of the maximum are interpolated. The signal <code>dinput</code> is then decomposed into a linear superposition of Lorentzian peaks at the determined positions and with the determined curvatures.</p><p><code>peaks()</code> returns a <code>PeakStruct</code> data structure</p><p>where <code>positions</code> and <code>heights</code> are the interpolated peak positions and heights, respectively; <code>widths</code> are the peak curvatures, which correspond to 1/FWHM line widths of the Lorentzian peaks. <code>intensities</code> are the peak intensities resulting from deconvolution. These values are proportional to the underlying concentrations in an NMR spectrum. Finally, <code>deconvolution</code> contains the deconvoluted approximation to the original input signal.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/marcel-utz/NMR.jl/blob/60c7aacb0d9c677814c4e653dc4a17bdd8df2854/src/Peaks.jl#L53-L73">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NMR.readBrukerFID-Tuple{String}" href="#NMR.readBrukerFID-Tuple{String}"><code>NMR.readBrukerFID</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><code>Bruker.readBrukerFID(s::String; format=Float64)</code> reads a Bruker fid or ser file and returns the data contained in it as a complex array. For files generated by TopSpin 4.0 and higher, the default format (<code>Float64</code>) will work. For TopSpin 2.0, use <code>format=Int32</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/marcel-utz/NMR.jl/blob/60c7aacb0d9c677814c4e653dc4a17bdd8df2854/src/Bruker.jl#L13-L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NMR.readBrukerParameterFile-Tuple{String}" href="#NMR.readBrukerParameterFile-Tuple{String}"><code>NMR.readBrukerParameterFile</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><code>readBrukerParameterFile(s::String)</code></p><p>reads a Bruker JCAMP-DX parameter file, and returns a dict with the values. Arrays such as D0 D1 D2 etc are returned as a Julia array. Note that the Bruker parameter <code>D0</code> appears as <code>param[&quot;D&quot;][1]</code> due to Julia using 1-based arrays.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/marcel-utz/NMR.jl/blob/60c7aacb0d9c677814c4e653dc4a17bdd8df2854/src/Bruker.jl#L36-L42">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NMR.shift-Tuple{PeakStruct, Real}" href="#NMR.shift-Tuple{PeakStruct, Real}"><code>NMR.shift</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">shift(p::PeakStruct,delta::Real)</code></pre><p>Shift the positions of all peaks in <code>p</code> by delta</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/marcel-utz/NMR.jl/blob/60c7aacb0d9c677814c4e653dc4a17bdd8df2854/src/Peaks.jl#L17-L21">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NMR.smooth" href="#NMR.smooth"><code>NMR.smooth</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">smooth(d::Data1D,n=10)</code></pre><p>returns a smoothed version of the input data set <code>d</code>, using convolution with a Gaussian peak.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/marcel-utz/NMR.jl/blob/60c7aacb0d9c677814c4e653dc4a17bdd8df2854/src/Peaks.jl#L28-L33">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NMR.Data1D" href="#NMR.Data1D"><code>NMR.Data1D</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Data1D(f&lt;:AbstractArray,start&lt;:Real,stop&lt;:Real)</code></pre><p>returns a data structure to hold a 1D NMR dataset either in the time or the frequency domain. <code>Data1D</code> objects store an <em>index</em> (range of time points or frequency points) along with the corresponding y-axis <em>data</em>. <code>Data1D</code> objects can be added and subtracted from one another, as long as their  indices match.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/marcel-utz/NMR.jl/blob/60c7aacb0d9c677814c4e653dc4a17bdd8df2854/src/DataSet.jl#L31-L37">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NMR.PeakStruct" href="#NMR.PeakStruct"><code>NMR.PeakStruct</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mutable struct PeakStruct</code></pre><p>Data structure to hold a peak list.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/marcel-utz/NMR.jl/blob/60c7aacb0d9c677814c4e653dc4a17bdd8df2854/src/Peaks.jl#L4-L8">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NMR.GISSMO.Hamiltonian-Tuple{String}" href="#NMR.GISSMO.Hamiltonian-Tuple{String}"><code>NMR.GISSMO.Hamiltonian</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">function Hamiltonian(fn::String;freq=600.0,ctr=4.8)
function Hamiltonian(system::XMLElement;freq=600.0,ctr=4.8)</code></pre><p>computes the Hamiltonian of an entry in the GISSMO database and returns it in the natural basis as a sparse matrix. <code>fn</code> is the GISSMO reference name of the compound. Keyword parameters are used to indicate spectrometer base frequency (in MHz) and the spectral zero point (carrier position) in ppm.  <code>maxSpin</code> represents the maximum size of the spin system that will be simulated. If the spin system size exceeds <code>maxSpin</code>, the function returns <code>(-1,nothing)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/marcel-utz/NMR.jl/blob/60c7aacb0d9c677814c4e653dc4a17bdd8df2854/src/GISSMO.jl#L19-L28">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NMR.HMDB.decompositionMatrix-Tuple{Any, Any}" href="#NMR.HMDB.decompositionMatrix-Tuple{Any, Any}"><code>NMR.HMDB.decompositionMatrix</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">decompositionMatrix(names,range)</code></pre><p>compute a decomposition matrix B such that B s  is the vector of concentrations of the metabolites listed in <code>names</code>. The pseudo-inverse is used for this purpose.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/marcel-utz/NMR.jl/blob/60c7aacb0d9c677814c4e653dc4a17bdd8df2854/src/HMDB.jl#L197-L202">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NMR.HMDB.matchPeaks-Tuple{PeakStruct, NMR.HMDB.HMDBpeaks}" href="#NMR.HMDB.matchPeaks-Tuple{PeakStruct, NMR.HMDB.HMDBpeaks}"><code>NMR.HMDB.matchPeaks</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">(score,iscore,alpha,std) = matchPeaks(p::NMR.PeakStruct,ref::HMDBpeaks;tol=0.001)</code></pre><p>match the peaks in <code>p</code> to the reference <code>ref</code>. A tuple of four values is returned:</p><ul><li><code>score</code>: sum of the intensities of the peaks found, normalised by the height of the largest reference peak.  Missing peaks are counted as negative</li><li><code>iscore</code>: score normalised by the total intensity of the reference peaks (range -1...1)</li><li><code>alpha</code>: fitted normalised concentration</li><li><code>std</code>: mean error of fitted normalised concentration</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/marcel-utz/NMR.jl/blob/60c7aacb0d9c677814c4e653dc4a17bdd8df2854/src/HMDB.jl#L63-L71">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NMR.HMDB.matchReport-Tuple{PeakStruct}" href="#NMR.HMDB.matchReport-Tuple{PeakStruct}"><code>NMR.HMDB.matchReport</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">xml=matchReport(p::NMR.PeakStruct,tol=0.01,AutoShift=true,iscoreCutoff=0,Id=&quot;&quot;,verbose=true)</code></pre><p>match peaks in <code>p</code> against all metabolites in <code>HMDB.refPeaks</code>, and create a table of the results. If <code>AutoShift</code> is set to <code>true</code> (default), the <code>p</code> is automatically shfited for the greatest overlap with D-Glucose. <code>tol</code> is the matching tolerance for peak identification. Metabolites with iscores below <code>iscoreCutoff</code> are not reported. Metabolites are listed in decreasing order of concentration. <code>matchReport()</code> returns an XML object containing the listed data. <code>Id</code> is incorporated into the XML object as an attribute, to facilitate later identification of the match report.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/marcel-utz/NMR.jl/blob/60c7aacb0d9c677814c4e653dc4a17bdd8df2854/src/HMDB.jl#L122-L131">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NMR.HMDB.refSpectrum-Tuple{String, Vector{Float64}}" href="#NMR.HMDB.refSpectrum-Tuple{String, Vector{Float64}}"><code>NMR.HMDB.refSpectrum</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">s::Data1D = refSpectrum(name::String,range;lw=0.01)</code></pre><p>compute a reference spectrum over <code>range</code> using the peak positions in reference spectrum <code>name</code>. A Lorentzian line with half width <code>lw</code> is used. The reference spectrum is returned as a real <code>Data1D</code> object, unless the option <code>complex=true</code> is given.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/marcel-utz/NMR.jl/blob/60c7aacb0d9c677814c4e653dc4a17bdd8df2854/src/HMDB.jl#L162-L168">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../NMR-1.0/">« Roadmap to Version 1.0</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Tuesday 21 January 2025 12:58">Tuesday 21 January 2025</span>. Using Julia version 1.10.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
